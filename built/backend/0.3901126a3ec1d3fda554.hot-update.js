exports.id = 0;
exports.modules = {

/***/ "./src/backend/controllers/auth.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("Object.defineProperty(exports, \"__esModule\", { value: true });var _express = __webpack_require__(\"express\");var _express2 = _interopRequireDefault(_express);\nvar _fb = __webpack_require__(\"fb\");var _fb2 = _interopRequireDefault(_fb);\nvar _models = __webpack_require__(\"./src/backend/models/index.js\");\nvar _error = __webpack_require__(\"./src/backend/common/error.js\");function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}\n\nvar router = _express2.default.Router();\n\nvar createAuth = function createAuth(req, res, next) {var\n  fb_access_token = req.body.fb_access_token;\n  _fb2.default.setAccessToken(fb_access_token);\n  _fb2.default.api('me').\n  then(function (res) {\n    console.log(res);\n    return _models.User.findOne({ fb_user_id: 'a' }).\n    then(function (user) {\n      if (!user) throw new _error.AuthorizationError();\n      return _models.Auth.sign(user);\n    }).\n    then(function (auth) {return auth.save();}).\n    then(function (auth) {\n      res.cookie('token', auth.token);\n      res.return({ auth: auth });\n    });\n  }).\n  catch(next);\n};\n\nvar destroyAuth = function destroyAuth(req, res, next) {var\n  token = req.cookies.token;\n  _models.Auth.findOne({ token: token }).\n  then(function (auth) {\n    if (!auth) return auth;\n    return auth.remove();\n  }).\n  then(function (auth) {\n    res.cookie('token', '');\n    res.return({ auth: auth });\n  }).\n  catch(next);\n};\n\nrouter.route('/').\npost(createAuth).\ndelete(destroyAuth);exports.default =\n\nrouter;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFja2VuZC9jb250cm9sbGVycy9hdXRoLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2JhY2tlbmQvY29udHJvbGxlcnMvYXV0aC5qcz8yYWU5Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7dmFyIF9leHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO3ZhciBfZXhwcmVzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leHByZXNzKTtcbnZhciBfZmIgPSByZXF1aXJlKCdmYicpO3ZhciBfZmIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmIpO1xudmFyIF9tb2RlbHMgPSByZXF1aXJlKCcvbW9kZWxzJyk7XG52YXIgX2Vycm9yID0gcmVxdWlyZSgnL2NvbW1vbi9lcnJvcicpO2Z1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7cmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07fVxuXG52YXIgcm91dGVyID0gX2V4cHJlc3MyLmRlZmF1bHQuUm91dGVyKCk7XG5cbnZhciBjcmVhdGVBdXRoID0gZnVuY3Rpb24gY3JlYXRlQXV0aChyZXEsIHJlcywgbmV4dCkge3ZhclxuICBmYl9hY2Nlc3NfdG9rZW4gPSByZXEuYm9keS5mYl9hY2Nlc3NfdG9rZW47XG4gIF9mYjIuZGVmYXVsdC5zZXRBY2Nlc3NUb2tlbihmYl9hY2Nlc3NfdG9rZW4pO1xuICBfZmIyLmRlZmF1bHQuYXBpKCdtZScpLlxuICB0aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgIHJldHVybiBfbW9kZWxzLlVzZXIuZmluZE9uZSh7IGZiX3VzZXJfaWQ6ICdhJyB9KS5cbiAgICB0aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICBpZiAoIXVzZXIpIHRocm93IG5ldyBfZXJyb3IuQXV0aG9yaXphdGlvbkVycm9yKCk7XG4gICAgICByZXR1cm4gX21vZGVscy5BdXRoLnNpZ24odXNlcik7XG4gICAgfSkuXG4gICAgdGhlbihmdW5jdGlvbiAoYXV0aCkge3JldHVybiBhdXRoLnNhdmUoKTt9KS5cbiAgICB0aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICByZXMuY29va2llKCd0b2tlbicsIGF1dGgudG9rZW4pO1xuICAgICAgcmVzLnJldHVybih7IGF1dGg6IGF1dGggfSk7XG4gICAgfSk7XG4gIH0pLlxuICBjYXRjaChuZXh0KTtcbn07XG5cbnZhciBkZXN0cm95QXV0aCA9IGZ1bmN0aW9uIGRlc3Ryb3lBdXRoKHJlcSwgcmVzLCBuZXh0KSB7dmFyXG4gIHRva2VuID0gcmVxLmNvb2tpZXMudG9rZW47XG4gIF9tb2RlbHMuQXV0aC5maW5kT25lKHsgdG9rZW46IHRva2VuIH0pLlxuICB0aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgaWYgKCFhdXRoKSByZXR1cm4gYXV0aDtcbiAgICByZXR1cm4gYXV0aC5yZW1vdmUoKTtcbiAgfSkuXG4gIHRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICByZXMuY29va2llKCd0b2tlbicsICcnKTtcbiAgICByZXMucmV0dXJuKHsgYXV0aDogYXV0aCB9KTtcbiAgfSkuXG4gIGNhdGNoKG5leHQpO1xufTtcblxucm91dGVyLnJvdXRlKCcvJykuXG5wb3N0KGNyZWF0ZUF1dGgpLlxuZGVsZXRlKGRlc3Ryb3lBdXRoKTtleHBvcnRzLmRlZmF1bHQgPVxuXG5yb3V0ZXI7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvYmFja2VuZC9jb250cm9sbGVycy9hdXRoLmpzXG4vLyBtb2R1bGUgaWQgPSAuL3NyYy9iYWNrZW5kL2NvbnRyb2xsZXJzL2F1dGguanNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/backend/controllers/auth.js\n");

/***/ })

};