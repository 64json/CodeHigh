webpackJsonp([0],{1140:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(4),o=n(i),c=a(131),_=a(1141),f=n(_),d=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={stars:null},a}return s(t,e),u(t,[{key:"onMouseEnter",value:function(e){this.setState({stars:e})}},{key:"onMouseLeave",value:function(){this.setState({stars:null})}},{key:"render",value:function(){var e=this,t=this.props,a=t.stars,n=t.rate,r=this.state.stars;return o.default.createElement("div",{className:f.default.rating},[1,2,3,4,5].map(function(t){var l=r?t>r:!a||t>a;return o.default.createElement("div",{key:t,className:(0,c.classes)(f.default.star,l&&f.default.disabled),onMouseEnter:function(){return e.onMouseEnter(t)},onMouseLeave:function(){return e.onMouseLeave()},onClick:function(){return n(t)}},o.default.createElement("span",null,"⭐️"))}))}}]),t}(o.default.Component);t.default=d},1141:function(e,t){e.exports={rating:"rating__3S7uu",star:"star__2erVT",disabled:"disabled__1uh0o"}},1142:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_dec,_class,_react=__webpack_require__(4),_react2=_interopRequireDefault(_react),_reactRouterDom=__webpack_require__(120),_reactAce=__webpack_require__(253),_reactAce2=_interopRequireDefault(_reactAce),_reactRedux=__webpack_require__(123);__webpack_require__(130),__webpack_require__(258),__webpack_require__(259);var _stylesheet=__webpack_require__(1143),_stylesheet2=_interopRequireDefault(_stylesheet),_util=__webpack_require__(131),_chai=__webpack_require__(421),_chai2=_interopRequireDefault(_chai),_randomstring=__webpack_require__(1144),_randomstring2=_interopRequireDefault(_randomstring),_index=__webpack_require__(179),TopicView=(_dec=(0,_reactRedux.connect)(function(e){return{env:e.env}}),(0,_reactRouterDom.withRouter)(_class=_dec(_class=function(_React$Component){function TopicView(e){_classCallCheck(this,TopicView);var t=_possibleConstructorReturn(this,(TopicView.__proto__||Object.getPrototypeOf(TopicView)).call(this,e)),a=e.match.params.topic_id;return t.state={topic_id:a,errors:null,code:null,topic:{title:"",content:"",time:180,testcases:[]}},t}return _inherits(TopicView,_React$Component),_createClass(TopicView,[{key:"componentDidMount",value:function(){var e=this,t=this.state.topic_id;"new"!==t&&_index.TopicApi.getTopic(t).then(function(t){var a=t.topic;return e.setState({topic:a})}).catch(console.error)}},{key:"onChange",value:function(e){this.setState({code:e})}},{key:"run",value:function run(){var _state=this.state,code=_state.code,topic=_state.topic;if(null!==code&&""!==code){var expect=_chai2.default.expect,errors=topic.testcases.map(function(testcase){try{eval(code+";"+testcase.eval)}catch(e){return e}});this.setState({errors:errors})}}},{key:"updateTopic",value:function(e){this.setState({topic:_extends({},this.state.topic,e)})}},{key:"updateTestcase",value:function(e,t){var a=[].concat(_toConsumableArray(this.state.topic.testcases)),n=a.findIndex(function(t){return t._tid===e});a[n]=_extends({},a[n],t),this.updateTopic({testcases:a})}},{key:"removeTestcase",value:function(e){var t=[].concat(_toConsumableArray(this.state.topic.testcases)),a=t.findIndex(function(t){return t._tid===e});t.splice(a,1),this.updateTopic({testcases:t})}},{key:"onMinuteChange",value:function(e){var t=Number(e.target.value)%100,a=60*t+this.state.topic.time%60;isNaN(a)||this.updateTopic({time:a})}},{key:"onSecondChange",value:function(e){var t=Number(e.target.value)%100;t>=60&&(t%=10);var a=60*(this.state.topic.time/60|0)+t;isNaN(a)||this.updateTopic({time:a})}},{key:"onTitleChange",value:function(e){var t=e.target.value;this.updateTopic({title:t})}},{key:"onContentChange",value:function(e){var t=e.target.value;this.updateTopic({content:t})}},{key:"addTestcase",value:function(){this.updateTopic({testcases:[].concat(_toConsumableArray(this.state.topic.testcases),[{_tid:_randomstring2.default.generate(),eval:"",public:!0}])})}},{key:"save",value:function(){var e=this,t=this.state,a=t.topic_id,n=t.topic;("new"===a?_index.TopicApi.addTopic(n):_index.TopicApi.updateTopic(a,n)).then(function(){return e.setState({topic_id:null})}).catch(console.error)}},{key:"remove",value:function(){var e=this,t=this.state.topic_id;"new"===t?this.setState({topic_id:null}):_index.TopicApi.deleteTopic(t).then(function(){return e.setState({topic_id:null})}).catch(console.error)}},{key:"render",value:function(){var e=this,t=this.props.env.author,a=this.state,n=a.topic_id,r=a.errors,l=a.code,s=a.topic;if(!t||!n)return _react2.default.createElement(_reactRouterDom.Redirect,{to:"/"});var u=""===s.title||""===s.content||0===s.testcases.length||s.testcases.some(function(e){return""===e.eval});return _react2.default.createElement("div",{className:_stylesheet2.default.topic_view},_react2.default.createElement("div",{className:_stylesheet2.default.status},_react2.default.createElement("input",{className:_stylesheet2.default.time,type:"text",value:(0,_util.nn)(s.time/60|0),onChange:function(t){return e.onMinuteChange(t)}}),":",_react2.default.createElement("input",{className:_stylesheet2.default.time,type:"text",value:(0,_util.nn)(s.time%60),onChange:function(t){return e.onSecondChange(t)}})),_react2.default.createElement("div",{className:_stylesheet2.default.problem_panel},_react2.default.createElement("input",{className:_stylesheet2.default.title,type:"text",value:s.title,onChange:function(t){return e.onTitleChange(t)},placeholder:"Title"}),_react2.default.createElement("textarea",{className:_stylesheet2.default.content,onChange:function(t){return e.onContentChange(t)},rows:4,value:s.content,placeholder:"Description"}),s.testcases.map(function(t){return _react2.default.createElement("div",{className:_stylesheet2.default.sample,key:t._tid},_react2.default.createElement(_reactAce2.default,{className:_stylesheet2.default.editor,value:t.eval||"",onChange:function(a){return e.updateTestcase(t._tid,{eval:a})},mode:"javascript",theme:"monokai",name:"editor"}),_react2.default.createElement("div",{className:_stylesheet2.default.control},_react2.default.createElement("label",{className:_stylesheet2.default.visible},_react2.default.createElement("input",{type:"checkbox",checked:t.public,onChange:function(a){return e.updateTestcase(t._tid,{public:a.target.checked})}}),_react2.default.createElement("span",null,"Visible")),_react2.default.createElement("a",{href:"#",className:_stylesheet2.default.remove,onClick:function(){return e.removeTestcase(t._tid)}},"Remove")))}),_react2.default.createElement("div",{className:(0,_util.classes)(_stylesheet2.default.button,_stylesheet2.default.add_testcase),onClick:function(){return e.addTestcase()}},_react2.default.createElement("span",null,"Add a Testcase")),_react2.default.createElement("div",{className:_stylesheet2.default.toolbar},_react2.default.createElement("a",{href:"#",className:(0,_util.classes)(_stylesheet2.default.button,_stylesheet2.default.save,u&&_stylesheet2.default.disabled),onClick:function(){return e.save()}},_react2.default.createElement("span",null,"Save")),_react2.default.createElement("a",{href:"#",className:(0,_util.classes)(_stylesheet2.default.button,_stylesheet2.default.remove),onClick:function(){return e.remove()}},_react2.default.createElement("span",null,"Remove")))),_react2.default.createElement("div",{className:_stylesheet2.default.status_panel},_react2.default.createElement("span",null,"1. Write the title and description of the problem."),_react2.default.createElement("span",null,"2. Add testcases using ",_react2.default.createElement("a",{href:"http://chaijs.com/api/bdd/",target:"_blank"},"Chai"),"."),_react2.default.createElement("span",null,"3. (Optional) Write a solution to test the testcases."),_react2.default.createElement("span",null,"4. Set the timer according to the difficulty of the problem."),_react2.default.createElement("span",null,"5. Click 'Save' button.")),_react2.default.createElement("div",{className:_stylesheet2.default.ide_panel},_react2.default.createElement("div",{className:(0,_util.classes)(_stylesheet2.default.player)},_react2.default.createElement("div",{className:_stylesheet2.default.picture,style:{backgroundImage:"url(http://graph.facebook.com/"+t.fb_user_id+"/picture?type=square)"}}),_react2.default.createElement("div",{className:_stylesheet2.default.name},t.name)),_react2.default.createElement(_reactAce2.default,{className:_stylesheet2.default.editor,value:l||"",onChange:function(t){return e.onChange(t)},mode:"javascript",theme:"monokai",name:"editor"}),_react2.default.createElement("div",{className:_stylesheet2.default.toolbar},_react2.default.createElement("a",{href:"#",className:(0,_util.classes)(_stylesheet2.default.button,_stylesheet2.default.run),onClick:function(){return e.run()}},_react2.default.createElement("span",null,"Run"))),r&&_react2.default.createElement("div",{className:_stylesheet2.default.console},r.map(function(e,t){return _react2.default.createElement("div",{className:_stylesheet2.default.testcase,key:t},_react2.default.createElement("span",{className:_stylesheet2.default.number},"Testcase #",t+1),void 0===e?_react2.default.createElement("span",{className:_stylesheet2.default.pass},"pass"):_react2.default.createElement("span",{className:_stylesheet2.default.fail},e.toString()))}))))}}]),TopicView}(_react2.default.Component))||_class)||_class);exports.default=TopicView},1143:function(e,t){e.exports={topic_view:"topic_view__1F8Xg",status:"status__2bbPw",time:"time__nUjEZ",problem_panel:"problem_panel__3cUdo",title:"title__1Ehi4",content:"content__3Up-N",sample:"sample__1yYE2",editor:"editor__25aTU",control:"control__1l6P1",visible:"visible__GUl8F",remove:"remove__1K-GP",button:"button__13cJZ",add_testcase:"add_testcase__3Vxmw",save:"save__1_rUK",disabled:"disabled__la2Mm",toolbar:"toolbar__vS30w",player:"player__2viWG",picture:"picture__2prgF",name:"name__1QwL_",status_panel:"status_panel__1y3mz",ide_panel:"ide_panel__jDcGf",run:"run__3R3aP",console:"console__1MBwA",testcase:"testcase__N9cfH",number:"number__1zVFe",pass:"pass__pJOp4",fail:"fail__Mduzc"}},1150:function(e,t){},1185:function(e,t){},1186:function(e,t){},1253:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,i,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},c=function(){function e(e,t){var a=[],n=!0,r=!1,l=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,l=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw l}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),f=a(4),d=n(f),p=a(1254),m=n(p),h=a(120),v=a(123),y=a(179),b=a(237),g=a(131),E=a(253),w=n(E);a(130),a(258),a(259);var k=a(428),N=a(179),O=(u=(0,v.connect)(function(e){return{env:e.env}}),(0,h.withRouter)(i=u(i=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={topics:[],opened:null,rating:null},a}return s(t,e),_(t,[{key:"componentDidMount",value:function(){var e=this;y.TopicApi.allTopics({populate:"author,top_solutions.author"}).then(function(t){var a=t.topics;return e.setState({topics:a})}).catch(console.error)}},{key:"open",value:function(e){var t=this,a=this.props.env.author,n=this.state.opened===e._id?null:e._id;n&&a?N.RatingApi.allRatings({solution:e._id,author:a._id}).then(function(e){var a=e.ratings,r=c(a,1),l=r[0];t.setState({opened:n,rating:l})}).catch(console.error):this.setState({opened:n})}},{key:"rate",value:function(e,t){var a=this;N.SolutionApi.rateSolution(e._id,{stars:t}).then(function(e){var n=e.solution,r=o({},a.state.rating);r.solution===n._id&&(r.stars=t,a.setState({rating:r}));for(var l=JSON.parse(JSON.stringify(a.state.topics)),s=0;s<l.length;s++)for(var u=0;u<l[s].top_solutions.length;u++)l[s].top_solutions[u]._id===n._id&&(l[s].top_solutions[u].average_stars=n.average_stars);a.setState({topics:l})}).catch(console.error)}},{key:"render",value:function(){var e=this,t=this.props.env.author,a=this.state,n=a.topics,r=a.opened,l=a.rating;return d.default.createElement("div",{className:m.default.home_view},d.default.createElement("div",{className:m.default.cover},d.default.createElement("span",{className:m.default.slogan},"“Hi ",t?t.first_name:"stranger",",",d.default.createElement("br",null),"wanna be code high",d.default.createElement("br",null),"with me?”"),t?d.default.createElement("div",{className:m.default.button_container},d.default.createElement(h.Link,{to:"/compete",className:m.default.button},"COMPETE NOW"),d.default.createElement(h.Link,{to:"/topic/new",className:m.default.button},"PROPOSE A TOPIC")):d.default.createElement("div",{className:m.default.button_container},d.default.createElement(b.Login,{onResponse:this.props.signIn},d.default.createElement("a",{href:"#",className:m.default.button},"SIGN IN")))),d.default.createElement("div",{className:m.default.topics},d.default.createElement("div",{className:m.default.section},d.default.createElement("span",null,"Topics")),n.map(function(a){return d.default.createElement("div",{className:m.default.topic,key:a._id},d.default.createElement("div",{className:m.default.title_row},d.default.createElement("div",{className:m.default.player},t&&t._id===a.author._id?d.default.createElement(h.Link,{to:"/topic/"+a._id,className:(0,g.classes)(m.default.title,m.default.owned)},a.title):d.default.createElement("div",{className:m.default.title},a.title),d.default.createElement("div",{className:m.default.space}),d.default.createElement("div",{className:m.default.picture,style:{backgroundImage:"url(http://graph.facebook.com/"+a.author.fb_user_id+"/picture?type=square)"}}),d.default.createElement("div",{className:m.default.name},a.author.name)),d.default.createElement("div",{className:m.default.content},a.content)),a.top_solutions.map(function(n,s){return d.default.createElement("div",{className:m.default.row,key:s},d.default.createElement("div",{onClick:function(){return e.open(n)},className:(0,g.classes)(m.default.player)},d.default.createElement("div",{className:m.default.picture,style:{backgroundImage:"url(http://graph.facebook.com/"+n.author.fb_user_id+"/picture?type=square)"}}),d.default.createElement("div",{className:m.default.name},n.author.name),d.default.createElement("div",{className:m.default.rating},d.default.createElement("span",{className:m.default.symbol},"⭐"),d.default.createElement("span",{className:m.default.number},"️",n.average_stars?n.average_stars.toFixed(1):0))),n._id===r&&d.default.createElement(w.default,{className:m.default.editor,value:n.code,mode:"javascript",theme:"monokai",name:"editor",readOnly:!0}),n._id===r&&t&&d.default.createElement(k.Rating,{stars:l?l.stars:0,rate:function(t){return e.rate(n,t)}}),n._id===r&&d.default.createElement(b.Comments,{href:"http://localhost:8080/"+a._id+"/"+n._id,colorScheme:"dark",className:m.default.comment}))}))})))}}]),t}(d.default.Component))||i)||i);t.default=O},1254:function(e,t){e.exports={home_view:"home_view__1snMn",cover:"cover__1gRfL",slogan:"slogan__JPWsV",button_container:"button_container__3kki1",button:"button__vaRiN",topics:"topics__trtUq",section:"section__GA_7p",topic:"topic__2YUYf",title_row:"title_row__2ElU3",player:"player__3N-ft",title:"title__20-pk",owned:"owned__20b9t",space:"space__1Vb8F",picture:"picture__1iuBR",content:"content__1VYNQ",row:"row__1W8Xe",name:"name__2q0NX",rating:"rating__2qWoY",symbol:"symbol__24EbM",number:"number__eNyW2",editor:"editor__2Z6iZ",comment:"comment__2Qxnx"}},1255:function(e,t){e.exports={app:"app__ptZiu",home:"home__cHByb",header:"header__37iiX",title:"title__1sIay",space:"space__3Ls6C",sign_in:"sign_in__2zj4p"}},1256:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(363);Object.defineProperty(t,"env",{enumerable:!0,get:function(){return n(r).default}})},131:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(function(e){return e}).join(" ")},r=function(e){return e<10?"0"+e:e},l=function(e){return e},s=function(e,t){return e&&e._id.equals(t._id)};t.classes=n,t.nn=r,t.isUser=l,t.isSelf=s},179:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserApi=t.TopicApi=t.SolutionApi=t.RatingApi=t.AuthApi=void 0;var r=function(){function e(e,t){var a=[],n=!0,r=!1,l=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,l=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw l}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=a(1233),s=n(l),u=a(1234),i=n(u);i.default.interceptors.response.use(function(e){return e.data},function(e){return s.default.reject(e.response.data)});var o=function(e,t){var a=e.split("/");return function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return new s.default(function(e,r){var l="/api"+a.map(function(e,t){return e.startsWith(":")?n.shift():e}).join("/");return e(t(l,n))})}},c=function(e){return o(e,function(e,t){var a=r(t,1),n=a[0];return i.default.get(e,{params:n})})},_=function(e){return o(e,function(e,t){var a=r(t,1),n=a[0];return i.default.delete(e,{params:n})})},f=function(e){return o(e,function(e,t){var a=r(t,2),n=a[0],l=a[1];return i.default.post(e,n,{params:l})})},d=function(e){return o(e,function(e,t){var a=r(t,2),n=a[0],l=a[1];return i.default.put(e,n,{params:l})})},p={createAuth:f("/auth/"),destroyAuth:_("/auth/")},m={allRatings:c("/rating/"),addRating:f("/rating/"),getRating:c("/rating/:rating_id"),updateRating:d("/rating/:rating_id"),deleteRating:_("/rating/:rating_id")},h={allSolutions:c("/solution/"),addSolution:f("/solution/"),getSolution:c("/solution/:solution_id"),updateSolution:d("/solution/:solution_id"),deleteSolution:_("/solution/:solution_id"),rateSolution:f("/solution/:solution_id/rate")},v={allTopics:c("/topic/"),addTopic:f("/topic/"),getTopic:c("/topic/:topic_id"),updateTopic:d("/topic/:topic_id"),deleteTopic:_("/topic/:topic_id")},y={allUsers:c("/user/"),addUser:f("/user/"),getUser:c("/user/:user_id"),updateUser:d("/user/:user_id"),deleteUser:_("/user/:user_id")};t.AuthApi=p,t.RatingApi=m,t.SolutionApi=h,t.TopicApi=v,t.UserApi=y},362:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,i,o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},_=a(4),f=n(_),d=a(123),p=a(363),m=a(120),h=a(379),v=n(h),y=a(237),b=a(908),g=a(179),E=a(1255),w=n(E),k=a(131),N=(u=(0,d.connect)(function(e){return{env:e.env}},c({},p.actions)),(0,m.withRouter)(i=u(i=function(e){function t(){return r(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this;v.default.get("token")&&g.UserApi.getUser("me").then(function(t){return e.props.setAuthor(t.user)})}},{key:"signIn",value:function(e){var t=this,a=e.tokenDetail.accessToken;g.AuthApi.createAuth({fb_access_token:a}).then(function(){return g.UserApi.getUser("me")}).then(function(e){return t.props.setAuthor(e.user)})}},{key:"signOut",value:function(){var e=this;g.AuthApi.destroyAuth().then(function(){return e.props.setAuthor(null)})}},{key:"render",value:function(){var e=this,t=this.props.env.author,a="/"===this.props.location.pathname;return f.default.createElement("div",{className:(0,k.classes)(w.default.app,a&&w.default.home)},f.default.createElement("header",{className:w.default.header},f.default.createElement(m.Link,{to:"/",className:w.default.title},f.default.createElement("span",null,"CodeHigh")),f.default.createElement("div",{className:w.default.space}),t?f.default.createElement("a",{href:"#",className:w.default.sign_in,onClick:function(){return e.signOut()}},"Sign Out"):f.default.createElement(y.Login,{onResponse:function(t){return e.signIn(t)}},f.default.createElement("a",{href:"#",className:w.default.sign_in},"Sign In"))),f.default.createElement(m.Switch,null,f.default.createElement(m.Route,{exact:!0,path:"/",component:function(t){return f.default.createElement(b.HomeView,c({},t,{signIn:function(t){return e.signIn(t)}}))}}),f.default.createElement(m.Route,{path:"/compete",component:b.CompeteView}),f.default.createElement(m.Route,{path:"/topic/:topic_id",component:b.TopicView})))}}]),t}(f.default.Component))||i)||i);t.default=N},363:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.actions=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=a(807),l=(0,r.createAction)("ENVIRONMENT/SET_AUTHOR",function(e){return{author:e}}),s=(t.actions={setAuthor:l},{}),u={author:null};t.default=(0,r.handleActions)(function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},l,function(e,t){var a=t.payload;return n({},e,a)}),n({},s,u))},428:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(362);Object.defineProperty(t,"App",{enumerable:!0,get:function(){return n(r).default}});var l=a(1140);Object.defineProperty(t,"Rating",{enumerable:!0,get:function(){return n(l).default}})},468:function(e,t,a){a(469),e.exports=a(670)},670:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l=a(4),s=n(l),u=a(316),i=n(u),o=a(342),c=a(120),_=a(123),f=a(804),d=a(362),p=n(d),m=a(1256),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(m),v=a(237),y=n(v),b=document.getElementById("root"),g=(0,o.createStore)((0,o.combineReducers)(r({},h,{routing:f.routerReducer}))),E=function(e){i.default.render(s.default.createElement(_.Provider,{store:g},s.default.createElement(y.default,{appId:"142939243124118"},s.default.createElement(c.BrowserRouter,null,s.default.createElement(e,null)))),b)};E(p.default)},908:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(909);Object.defineProperty(t,"CompeteView",{enumerable:!0,get:function(){return n(r).default}});var l=a(1142);Object.defineProperty(t,"TopicView",{enumerable:!0,get:function(){return n(l).default}});var s=a(1253);Object.defineProperty(t,"HomeView",{enumerable:!0,get:function(){return n(s).default}})},909:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_dec,_class,_react=__webpack_require__(4),_react2=_interopRequireDefault(_react),_reactRouterDom=__webpack_require__(120),_reactAce=__webpack_require__(253),_reactAce2=_interopRequireDefault(_reactAce),_reactRedux=__webpack_require__(123),_socket=__webpack_require__(915),_socket2=_interopRequireDefault(_socket);__webpack_require__(130),__webpack_require__(258),__webpack_require__(259);var _stylesheet=__webpack_require__(936),_stylesheet2=_interopRequireDefault(_stylesheet),_util=__webpack_require__(131),_js=__webpack_require__(379),_js2=_interopRequireDefault(_js),_reactHighlight=__webpack_require__(937),_reactHighlight2=_interopRequireDefault(_reactHighlight);__webpack_require__(1117);var _chai=__webpack_require__(421),_chai2=_interopRequireDefault(_chai),_components=__webpack_require__(428),socket=null,CompeteView=(_dec=(0,_reactRedux.connect)(function(e){return{env:e.env}}),(0,_reactRouterDom.withRouter)(_class=_dec(_class=function(_React$Component){function CompeteView(e){_classCallCheck(this,CompeteView);var t=_possibleConstructorReturn(this,(CompeteView.__proto__||Object.getPrototypeOf(CompeteView)).call(this,e));return t.state={last_time:null,time_elapsed:null,last_typed_time:null,errors:null,code:null,selected_fb_user_id:null,game:{started_at:null,updated_at:null,finished_at:null,players:[],topic:null}},t}return _inherits(CompeteView,_React$Component),_createClass(CompeteView,[{key:"componentDidMount",value:function(){var e=this,t=this.props.env.author;if(t){this.setState({selected_fb_user_id:t.fb_user_id});var a="http://"+window.location.hostname+":8183";socket=(0,_socket2.default)(a);var n=_js2.default.get("token");socket.emit("AUTH",{token:n}),socket.on("GAME_UPDATED",function(t){var a=t.started_at,n=t.updated_at,r=new Date,l=new Date(n)-new Date(a);e.setState({last_time:r,time_elapsed:l,game:t})}),socket.on("GAME_REMOVED",function(){return e.setState({game:null})})}this.intervalId=setInterval(function(){var a=e.state,n=a.last_time,r=a.time_elapsed,l=a.last_typed_time,s=e.findPlayer(t.fb_user_id),u=new Date;s&&(!s.typing&&u-l<300&&socket.emit("START_TYPING"),s.typing&&u-l>=300&&socket.emit("STOP_TYPING")),n&&e.setState(function(e){return{time_elapsed:r+(u-n),last_time:u}})},300)}},{key:"componentWillUnmount",value:function(){socket&&socket.disconnect(),clearInterval(this.intervalId)}},{key:"onChange",value:function(e){this.setState({last_typed_time:new Date,code:e,errors:null})}},{key:"run",value:function run(){var _state2=this.state,code=_state2.code,game=_state2.game;if(null!==code&&""!==code){var expect=_chai2.default.expect,errors=game.topic.testcases.map(function(testcase){try{eval(code+";"+testcase.eval)}catch(e){return e}});this.setState({errors:errors})}}},{key:"submit",value:function(){socket.emit("SUBMIT",this.state.code)}},{key:"giveUp",value:function(){socket.emit("GIVE_UP")}},{key:"select",value:function(e){this.setState({selected_fb_user_id:e.user.fb_user_id})}},{key:"findPlayer",value:function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.game.players).find(function(t){return t.user.fb_user_id===e})}},{key:"rate",value:function(e){var t=this.state.selected_fb_user_id,a=this.findPlayer(t),n=a.solution._id;socket.emit("RATE",{solution_id:n,stars:e})}},{key:"render",value:function(){var e=this,t=this.props.env.author,a=this.state,n=a.time_elapsed,r=a.errors,l=a.code,s=a.selected_fb_user_id,u=a.game,i=u.players,o=u.finished_at,c=u.topic;if(!t||!u)return _react2.default.createElement(_reactRouterDom.Redirect,{to:"/"});var _=this.findPlayer(t.fb_user_id)||{user:t,submitted_at:null,given_up_at:null,typing:!1,ratings:{},solution:null},f=this.findPlayer(s)||_,d=_react2.default.createElement("span",null,"Waiting for players");if(o)d=_react2.default.createElement("span",null,"Please vote");else if(c){var p=Math.max(c.time-n/1e3,0);d=_react2.default.createElement("span",{className:_stylesheet2.default.big},(0,_util.nn)(p/60|0)+":"+(0,_util.nn)(p%60|0))}var m=o||_.submitted_at||_.given_up_at,h=r&&r.every(function(e){return void 0===e}),v=c&&!m;return _react2.default.createElement("div",{className:_stylesheet2.default.compete_view},_react2.default.createElement("div",{className:_stylesheet2.default.status},d),c?_react2.default.createElement("div",{className:_stylesheet2.default.problem_panel},_react2.default.createElement("div",{className:_stylesheet2.default.title},c.title),_react2.default.createElement("div",{className:_stylesheet2.default.content},c.content),c.testcases.filter(function(e){return e.public}).map(function(e,t){return _react2.default.createElement(_reactHighlight2.default,{className:(0,_util.classes)(_stylesheet2.default.sample,"javascript"),key:t},e.eval)})):_react2.default.createElement("div",{className:_stylesheet2.default.problem_panel}),_react2.default.createElement("div",{className:_stylesheet2.default.status_panel},_react2.default.createElement("div",{className:_stylesheet2.default.versus},_react2.default.createElement("span",null,"Players")),i.map(function(t){return _react2.default.createElement("div",{onClick:function(){return m&&e.select(t)},className:(0,_util.classes)(_stylesheet2.default.player,t.given_up_at&&_stylesheet2.default.given_up,t.submitted_at&&_stylesheet2.default.submitted),key:t.user.fb_user_id},_react2.default.createElement("div",{className:_stylesheet2.default.picture,style:{backgroundImage:"url(http://graph.facebook.com/"+t.user.fb_user_id+"/picture?type=square)"}}),_react2.default.createElement("div",{className:_stylesheet2.default.name},t.user.name),t.typing&&_react2.default.createElement("img",{src:"/img/typing.svg",className:_stylesheet2.default.typing}),Object.keys(t.ratings).length>0&&_react2.default.createElement("div",{className:_stylesheet2.default.rating},_react2.default.createElement("span",{className:_stylesheet2.default.symbol},"⭐"),_react2.default.createElement("span",{className:_stylesheet2.default.number},"️",t.average_stars.toFixed(1))))})),_react2.default.createElement("div",{className:_stylesheet2.default.ide_panel},_react2.default.createElement("div",{className:(0,_util.classes)(_stylesheet2.default.player,f.given_up_at&&_stylesheet2.default.given_up,f.submitted_at&&_stylesheet2.default.submitted)},_react2.default.createElement("div",{className:_stylesheet2.default.picture,style:{backgroundImage:"url(http://graph.facebook.com/"+f.user.fb_user_id+"/picture?type=square)"}}),_react2.default.createElement("div",{className:_stylesheet2.default.name},f.user.name),f.typing&&_react2.default.createElement("img",{src:"/img/typing.svg",className:_stylesheet2.default.typing})),_react2.default.createElement(_reactAce2.default,{className:_stylesheet2.default.editor,value:(m?f.solution&&f.solution.code:l)||"",onChange:function(t){return e.onChange(t)},mode:"javascript",theme:"monokai",name:"editor",readOnly:!v}),v&&_react2.default.createElement("div",{className:_stylesheet2.default.toolbar},_react2.default.createElement("a",{href:"#",className:(0,_util.classes)(_stylesheet2.default.button,_stylesheet2.default.run),onClick:function(){return e.run()}},_react2.default.createElement("span",null,"Run")),_react2.default.createElement("a",{href:"#",className:(0,_util.classes)(_stylesheet2.default.button,_stylesheet2.default.give_up),onClick:function(){return e.giveUp()}},_react2.default.createElement("span",null,"Give Up"))),!m&&r&&_react2.default.createElement("div",{className:_stylesheet2.default.console},r.map(function(e,t){return _react2.default.createElement("div",{className:_stylesheet2.default.testcase,key:t},_react2.default.createElement("span",{className:_stylesheet2.default.number},"Testcase #",t+1),void 0===e?_react2.default.createElement("span",{className:_stylesheet2.default.pass},"pass"):_react2.default.createElement("span",{className:_stylesheet2.default.fail},e.toString()))})),!m&&h&&_react2.default.createElement("div",{className:_stylesheet2.default.toolbar},_react2.default.createElement("a",{href:"#",className:(0,_util.classes)(_stylesheet2.default.button,_stylesheet2.default.submit),onClick:function(){return e.submit()}},_react2.default.createElement("span",null,"Submit"))),m&&f.solution&&_react2.default.createElement(_components.Rating,{stars:f.ratings[t.fb_user_id],rate:function(t){return e.rate(t)}})))}}]),CompeteView}(_react2.default.Component))||_class)||_class);exports.default=CompeteView},932:function(e,t){},936:function(e,t){e.exports={compete_view:"compete_view__1jJqr",status:"status__2KLiV",big:"big__1MS9W",problem_panel:"problem_panel__2hHS6",title:"title__BNREp",content:"content__2VESX",sample:"sample__2Y-6o",player:"player__2VDrE",picture:"picture__2C9Dm",name:"name__1B5Yg",typing:"typing__2YBRm",rating:"rating__2KY7M",symbol:"symbol__2HUCO",number:"number__NS3pq",given_up:"given_up__1r72m",submitted:"submitted__1lUku",status_panel:"status_panel__3bpcS",versus:"versus__ygaIS",ide_panel:"ide_panel__5_yDb",editor:"editor__3-ohi",toolbar:"toolbar__38Wxc",button:"button__1PHXs",run:"run__2R3kC",give_up:"give_up__35BC3",submit:"submit__XukL-",console:"console__3SB7V",testcase:"testcase__1kP9l",pass:"pass__d1hhZ",fail:"fail__26lXW"}}},[468]);